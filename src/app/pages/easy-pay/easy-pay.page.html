
<ion-header [translucent]="true">
  <ion-toolbar>
    <div class="tool-header d-flex align-items-center py-4 w-100">
      <ion-buttons slot="start" class="text-black">
        <ion-back-button routerLink="/tabs/explore"></ion-back-button>
      </ion-buttons>

      <h1 class="m-0 flex-grow-1 text-center fs-2 text-black fw-bold me-4">Easy Pay</h1>
    </div>
  </ion-toolbar>
</ion-header>

<ion-content>
  <!-- Tabs -->
  <div>
    <ion-select
      class="mt-4 mb-3 px-3 rounded-4 mx-auto"
      aria-label="tab"
      [(ngModel)]="tab"
      placeholder="Type"
    >
      <ion-select-option value="tradein">Trade in</ion-select-option>
      <!-- <ion-select-option value="offers">Offers</ion-select-option> -->
    </ion-select>
  </div>

  <!-- TRADE IN SECTION -->
  @if(tab === 'tradein'){
    <div class="trade-in p-4">
      <!-- Intro -->
       @for(item of tradeIn() ; track $index){
        @if($index === 0){
          <div class="fs-3 text-center fw-bold " [innerHTML]="item.title"></div>
          <div class="tadeInDesc text-muted mt-3 mb-4" [innerHTML]="item.description"></div>
        }
       }

      <!-- Device Types -->
      <ion-grid>
        <ion-row>
          @for(type of types() ; track $index){
            <ion-col size="6" (click)="onTypeSelect(type.key || type.id)" class="text-center" >
              <div class="optionTradein w-100 h-100 pb-2" [class.active]="selectedType === (type.key || type.id)" >
                 <div>
                  <img loading="lazy" [src]="type.picture" [alt]="type.type" />
                </div>
                <div>
                  <span>{{ type.type }}</span>
                </div>
              </div>
            </ion-col>
          }
        </ion-row>
      </ion-grid>

      <!-- New Device -->
      <ion-list>
        <ion-item lines="none" class="rounded-4 border border-1">
          <ion-select label="New Device" label-placement="floating" [(ngModel)]="selectedNewDevice">
            @for(o of newDevices(); track $index){
              <ion-select-option [value]="o.amount">
                {{ o.title }}
              </ion-select-option>
            }
          </ion-select>
        </ion-item>
      </ion-list>

      <h3 class="text-center symbol">-</h3>

      <!-- Old Device -->
      <ion-list>
        <ion-item lines="none" class="rounded-4 border border-1">
          <ion-select label="Old Device" label-placement="floating" [(ngModel)]="selectedOldDevice">
            @for(o of oldDevices() ; track $index){
              <ion-select-option [value]="o.amount">
                {{ o.title }}
              </ion-select-option>
            }
          </ion-select>
        </ion-item>
      </ion-list>

      <h3 class="text-center symbol">=</h3>


      <h3 class="text-center fw-bold symbol border border-1 rounded-4 py-2">{{ resultAmount | number }}</h3>

      <!-- Details Section -->
       @for (item of tradeIn(); track $index) {
        <div class="terms-list mt-5">
          @if($index !== 0){
            <div class="mb-4 fw-bold" [innerHTML]="item.title | safeHtml"></div>
          }
          @if($index !== 0 && $index !== 1){
            <div [innerHTML]="getLogos(item.description) | safeHtml"></div>
          }
          @if($index === 1){
            <div class="rules-section text-center">
              <div class="row g-4">
                @for (rule of rules; track $index) {
                  <div class="col-12">
                    <div class="rule d-flex flex-column align-items-center gap-3">
                      <img loading="lazy" [src]="'/assets/images/easypay-images/trade-in/' + rule.icon" />
                      <span class="flex-grow-1">{{ rule.text }}</span>
                    </div>
                  </div>
                }
              </div>
            </div>
          }
        </div>
       }
    </div>
  }

  <!-- OFFERS (اختياري) -->
  @if(tab === 'offers'){
    @for( o of offers() ;  track $index){
      <div style="margin-bottom:10px; margin-top:12px">
        <img loading="lazy" [src]="o.picture" />
        <div style="padding:16px">
          <div class="offer-title" [innerHTML]="o.title"></div>
          <div [innerHTML]="o.description"></div>
        </div>
      </div>
    }
  }
</ion-content>

